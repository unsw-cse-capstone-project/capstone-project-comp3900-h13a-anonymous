{% extends "sidebar.html" %}
{% load static %}

{% block content %}
<h1>
    My Watch List
</h1>

{% for key, value in errors.items %}
<center>
    <h5 style="color:#FF0000;">{{value}}</h5>
</center>
{% endfor %}

<table style="width:100%" class="table">
    <tr>
        <th>Stock Code</th>
        <th>Stock Name</th>
        <th>Date Added</th>
        <th>Current Price</th>
        <th>Change Since Last Closing</th>
        <th></th>

    </tr>
    {% for w in wlist %}
    <tr>
        <td>{{w.code}}</td>
        <td> <a href="/stock/{{w.code}}"> {{w.name}} </a> </td>
        <td>{{w.date}}</td>
        <td>{{w.current}}</td>
        <td>{{w.change}}</td>
        <td> <a href="/charts/" class="btn btn-info" onclick="displayStock()" >Display</a>
        <td> <a href="/buy/{{w.code}}" class="btn btn-info">Buy</a>
        <td> <a href="/remove_watchlist/{{w.code}}" class="btn btn-info">Remove from watchlist</a></td>
    </tr>
    {% endfor %}
</table>
<div id="imageContainer">
</div>
<script>
    function displayStock() {
        // get the container element
        var imageContainer = document.getElementById("imageContainer");
        // clear all the child nodes before switching the stock
        imageContainer.querySelectorAll('*').forEach(n => n.remove());
        // get the new stock diagram from backend
        let imgDisplay = document.createElement('img');
        imgDisplay.src = "../media/images/sample_historical_data.jpg";
        imgDisplay.alt = "sample-historical-data";
        // store it to the image container
        imageContainer.appendChild(imgDisplay);
        // display the new graph
    }
</script>
{% endblock %}